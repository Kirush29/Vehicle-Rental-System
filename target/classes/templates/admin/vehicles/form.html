<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8"/>
    <title th:text="${vehicle?.id == null ? 'Add Vehicle' : 'Edit Vehicle'}">Vehicle Form</title>

    <style>
        body{font-family:Arial,Helvetica,sans-serif;margin:0;padding:20px;background:#f8fafc;color:#1e293b}
        .container{max-width:920px;margin:0 auto}
        h1{font-size:1.8rem;margin:0 0 16px;color:#0f172a}
        .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;background:#fff;padding:18px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.06)}
        .form-grid label{display:block;font-weight:600;margin-bottom:6px;color:#334155}
        .form-grid input,.form-grid select,.form-grid textarea{width:100%;padding:8px 10px;border:1px solid #cbd5e1;border-radius:6px;font-size:.95rem;background:#fff}
        .grid-col-span-2{grid-column:span 2}
        .preview-wrap{margin:14px 0 6px}
        .preview{width:260px;height:170px;object-fit:cover;border-radius:8px;border:1px solid #e5e7eb}
        .muted{font-size:.85rem;color:#64748b}
        .actions{margin-top:14px}
        .btn{display:inline-block;padding:8px 14px;border-radius:6px;text-decoration:none;background:#e2e8f0;color:#1e293b}
        .btn:hover{background:#cbd5e1}
        .btn-primary{background:#10b981;color:#fff}
        .btn-primary:hover{background:#059669}
    </style>
</head>
<body>
<div class="container">

    <!-- Thymeleaf model variable declaration for IDE -->
    <!--/*
    @thymesVar id="vehicle" type="com.vehiclerental.models.Vehicle"
    */-->

    <h1 th:text="${vehicle?.id == null ? 'Add Vehicle' : 'Edit Vehicle'}">Add Vehicle</h1>

    <form th:action="@{/admin/vehicles/save}" th:object="${vehicle}" method="post" class="form-grid">
        <!-- Hidden ID field -->
        <input type="hidden" th:field="*{id}" id="vehicleId"/>

        <!-- CSRF Token -->
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <!-- Make -->
        <div>
            <label for="make">Make</label>
            <input type="text" th:field="*{make}" id="make" required/>
        </div>

        <!-- Model -->
        <div>
            <label for="model">Model</label>
            <input type="text" th:field="*{model}" id="model" required/>
        </div>

        <!-- Year -->
        <div>
            <label for="year">Year</label>
            <input type="number" th:field="*{year}" id="year" min="1980" max="2100" required/>
        </div>

        <!-- Daily Rate -->
        <div>
            <label for="dailyRate">Daily Rate</label>
            <input type="number" th:field="*{dailyRate}" id="dailyRate" step="0.01" min="0" required/>
        </div>

        <!-- Type -->
        <div>
            <label for="type">Type</label>
            <input type="text" th:field="*{type}" id="type" placeholder="SEDAN / SUV / HATCH…"/>
        </div>

        <!-- Color -->
        <div>
            <label for="color">Color</label>
            <input type="text" th:field="*{color}" id="color"/>
        </div>

        <!-- License Plate -->
        <div>
            <label for="licensePlate">License Plate</label>
            <input type="text" th:field="*{licensePlate}" id="licensePlate" required/>
        </div>

        <!-- Mileage -->
        <div>
            <label for="mileage">Mileage</label>
            <input type="number" th:field="*{mileage}" id="mileage" min="0"/>
        </div>

        <!-- Status -->
        <div>
            <label for="status">Status</label>
            <select th:field="*{status}" id="status">
                <option value="AVAILABLE">AVAILABLE</option>
                <option value="RENTED">RENTED</option>
                <option value="MAINTENANCE">MAINTENANCE</option>
                <option value="UNAVAILABLE">UNAVAILABLE</option>
            </select>
        </div>

        <!-- Image URL -->
        <div class="grid-col-span-2">
            <label for="imageUrl">Image URL</label>
            <input type="text" th:field="*{imageUrl}" id="imageUrl" placeholder="https://example.com/image.jpg"/>
            <small class="muted">Provide a URL for the vehicle image</small>
        </div>

        <!-- Description -->
        <div class="grid-col-span-2">
            <label for="description">Description</label>
            <textarea rows="4" th:field="*{description}" id="description" placeholder="Enter vehicle description…"></textarea>
        </div>

        <!-- Image Preview -->
        <div class="grid-col-span-2 preview-wrap">
            <label class="muted">Image Preview</label><br/>
            <img th:if="${vehicle?.imageUrl != null and !vehicle.imageUrl.isEmpty()}"
                 th:src="${vehicle.imageUrl}"
                 class="preview"
                 alt="Vehicle Image"
                 onerror="this.src='/images/placeholder.png';"/>
            <img th:if="${vehicle?.imageUrl == null or vehicle.imageUrl.isEmpty()}"
                 src="/images/placeholder.png"
                 class="preview"
                 alt="No Image Available"/>
        </div>

        <!-- Actions -->
        <div class="grid-col-span-2 actions">
            <button type="submit" class="btn btn-primary">Save Vehicle</button>
            <a th:href="@{/admin/vehicles}" class="btn">Cancel</a>
        </div>
    </form>
</div>

<script>
    // Live preview for image URL
    document.getElementById('imageUrl')?.addEventListener('input', function() {
        const previews = document.querySelectorAll('.preview');
        const url = this.value.trim();

        if (url) {
            previews.forEach(preview => {
                preview.src = url;
            });
        }
    });
</script>
</body>
</html>