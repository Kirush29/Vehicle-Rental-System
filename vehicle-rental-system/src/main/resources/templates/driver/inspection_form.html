<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <title>DriveEase • Driver • Vehicle Inspection</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root{--primary:#2c3e50;--secondary:#3498db;--accent:#e74c3c;--dark:#2c3e50;--shadow:0 4px 6px rgba(0,0,0,.1)}
    *{box-sizing:border-box;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}
    body{margin:0;background:#f8f9fa;color:#333;min-height:100vh;display:flex;flex-direction:column}
    header{background:linear-gradient(135deg,var(--primary),#1f2a3a);color:#fff;padding:18px 0;box-shadow:var(--shadow)}
    .container{max-width:900px;margin:0 auto;padding:0 20px}
    .row{display:flex;align-items:center;justify-content:space-between}
    .logo{display:flex;align-items:center;gap:10px}
    .logo i{color:var(--secondary);font-size:28px}
    main{flex:1;padding:28px 0}
    .card{background:#fff;border-radius:12px;box-shadow:var(--shadow);padding:18px}
    label{display:block;margin:10px 0 6px;font-weight:700}
    input,select,textarea{width:100%;padding:12px;border:1px solid #ddd;border-radius:10px}
    .grid{display:grid;gap:14px}
    .g2{grid-template-columns:repeat(2,1fr)}
    .muted{opacity:.7}
    .btn{border:none;border-radius:10px;padding:12px 16px;font-weight:700;cursor:pointer}
    .btn-primary{background:#3498db;color:#fff}
    .btn-primary:hover{background:#2d7fbb}
    .btn-ghost{background:transparent;border:2px solid #3498db;color:#3498db}
    .err{background:#ffefef;border-left:4px solid #e74c3c;padding:10px;border-radius:8px;margin-bottom:10px}
    footer{background:var(--dark);color:#fff;padding:24px 0;margin-top:auto}
    .hint{font-size:12px;opacity:.7}
  </style>
</head>
<body>
<header>
  <div class="container">
    <div class="row">
      <div class="logo"><i class="fas fa-car"></i><h2 style="margin:0">DriveEase • Driver</h2></div>
      <div><a th:href="@{/driver/deliveries}" style="color:#fff;text-decoration:none">Back to Deliveries</a></div>
    </div>
  </div>
</header>

<main>
  <div class="container">
    <div class="card">
      <h3 style="margin-top:0">Vehicle Inspection</h3>

      <div class="muted" style="margin-bottom:10px">
        Delivery: <span th:text="${inspection.deliveryId}">0</span> • Vehicle: <span th:text="${inspection.vehicleId}">0</span>
      </div>

      <div th:if="${#fields.hasErrors('*')}" class="err">Please fix the errors and try again.</div>

      <form th:action="@{/driver/inspections}" th:object="${inspection}" method="post" enctype="multipart/form-data" onsubmit="return validateFiles()">
        <input type="hidden" th:field="*{deliveryId}" />
        <input type="hidden" th:field="*{vehicleId}" />

        <div class="grid g2">
          <div>
            <label>Odometer (km)</label>
            <input type="number" th:field="*{odometer}" min="1" required />
          </div>
          <div>
            <label>Fuel Level</label>
            <select th:field="*{fuelLevel}" required>
              <option value="">Select…</option>
              <option th:each="f : ${fuelLevels}" th:value="${f}" th:text="${f}"></option>
            </select>
          </div>

          <div>
            <label>Cleanliness</label>
            <select th:field="*{cleanliness}" required>
              <option value="">Select…</option>
              <option th:each="c : ${cleanlinessValues}" th:value="${c}" th:text="${c}"></option>
            </select>
          </div>
          <div>
            <label>Notes <span class="muted">(optional, ≤ 250)</span></label>
            <input type="text" th:field="*{notes}" maxlength="250" />
          </div>
        </div>

        <hr style="margin:16px 0;border:none;border-top:1px solid #eee" />

        <div class="grid g2">
          <div>
            <label>Front Photo</label>
            <input type="file" id="photoFront" name="photoFront" accept="image/*" required />
            <div class="hint">JPG/PNG • &lt; 5MB</div>
          </div>
          <div>
            <label>Rear Photo</label>
            <input type="file" id="photoRear" name="photoRear" accept="image/*" required />
            <div class="hint">JPG/PNG • &lt; 5MB</div>
          </div>
          <div>
            <label>Left Photo</label>
            <input type="file" id="photoLeft" name="photoLeft" accept="image/*" required />
            <div class="hint">JPG/PNG • &lt; 5MB</div>
          </div>
          <div>
            <label>Right Photo</label>
            <input type="file" id="photoRight" name="photoRight" accept="image/*" required />
            <div class="hint">JPG/PNG • &lt; 5MB</div>
          </div>
          <div>
            <label>Interior</label>
            <input type="file" id="photoInterior" name="photoInterior" accept="image/*" required />
            <div class="hint">JPG/PNG • &lt; 5MB</div>
          </div>
          <div>
            <label>Dashboard</label>
            <input type="file" id="photoDashboard" name="photoDashboard" accept="image/*" required />
            <div class="hint">JPG/PNG • &lt; 5MB</div>
          </div>
        </div>

        <div style="margin-top:16px;display:flex;gap:10px;justify-content:flex-end">
          <a th:href="@{/driver/deliveries}" class="btn btn-ghost">Cancel</a>
          <button class="btn btn-primary" type="submit"><i class="fa fa-save"></i>&nbsp;Submit Inspection</button>
        </div>
      </form>
    </div>
  </div>
</main>

<footer>
  <div class="container">© DriveEase Vehicle Rental • Driver</div>
</footer>

<script>
  function validateFiles(){
    const ids = ["photoFront","photoRear","photoLeft","photoRight","photoInterior","photoDashboard"];
    for(const id of ids){
      const f = document.getElementById(id).files[0];
      if(!f){ alert("Please upload all required photos."); return false; }
      if(!/image\/(jpeg|png)/i.test(f.type)){ alert("Only JPG/PNG allowed."); return false; }
      if(f.size > 5*1024*1024){ alert("Each image must be under 5MB."); return false; }
    }
    return true;
  }
</script>
</body>
</html>
